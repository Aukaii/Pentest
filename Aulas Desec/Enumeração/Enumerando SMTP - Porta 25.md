
Conectando com SMTP via netcat (Demora um tempo pra obter a resposta do servidor)
![[Pasted image 20231129173058.png]]

Interagindo com SMTP
```
HELO
EHLO
VRFY
```

Script para enumerar usu√°rios SMTP

```
#!/usr/bin/python
import socket,sys

if len(sys.argv) !=3:
	print "Modo de uso: python smtpenum.py IP Usuario"
	sys.exit(0)

tcp = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
tcp.connect((sys.argv[1],25))
banner = tcp.recv(1024)
print banner

tcp.send("VRFY "+sys.argv[2]+"\r\n")
user = tcp.recv(1024)
print user
```

Script para Bruteforce SMTP
```
#!/usr/bin/python
import socket,sys,re

file = open("lista.txt")
for linha in file:
	tcp = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	tcp.connect ((sys.argv[1],25))
	banner = tcp.recv(1024)
	tcp.send("VRFY "+linha)
	user = tcp.recv(1024)
	if re.search("252",user):
		print "Usuario encontrado: "+user.strip("252 2.0.0")
		

```