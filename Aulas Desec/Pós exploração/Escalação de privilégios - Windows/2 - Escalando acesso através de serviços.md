Pode acontecer de de ao tentar alterar o binpath o serviço de um erro de "Access Denies".
Isso significa que o serviço somente está autorizado a trabalhar com aquele determinado executável.

Para tomar vantagem disso podemos tentar alterar o executável que o serviço está chamando no binpath para um executável malicioso.
![[Pasted image 20231228115846.png]]

Basta renomear o executável original e colocar nossa shell com o nome do serviço que está no binpath
![[Pasted image 20231228120114.png]]

Enviando a shell com o nome do serviço para a pasta.
![[Pasted image 20231228120155.png]]

Como esse serviço nao permite que nós reiniciamos ele por linha de comando, podemos forçar um reinicio da máquina, já que o serviço é auto iniciável.
```
shutdown /r /t 0
```

Quando o sistema iniciar, receberemos nossa shell com privilegio System
![[Pasted image 20231228120440.png]]
