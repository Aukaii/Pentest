
Usuarios da máquina
![[Pasted image 20240224045739.png]]
Identifiquei que no diretporio da alice havia key do root
![[Pasted image 20240224052739.png]]

Portanto deduzi que a key de user poderia estar no diretório do root
![[Pasted image 20240224052811.png]]
dentro do diretorio há um script que está sendo permitido a execução do usuário rabbit
![[Pasted image 20240224052948.png]]

No inicio do script ele importa uma biblioteca "random"
![[Pasted image 20240224053030.png]]

Então, e se criarmos um arquivo chamado random.py em nosso diretório atual que executa /bin/bash? Dessa forma, nosso arquivo python deve ser carregado em vez do módulo random "real" e, por sua vez, nos fornecer um shell como usuário rabbit.
![[Pasted image 20240224053323.png]]

Executando o script
![[Pasted image 20240224053435.png]]
Dentro do usuário Rabbit existe um binario com permissão de root
![[Pasted image 20240224053740.png]]

ao executar ele espera uma entrada de dados
![[Pasted image 20240224053809.png]]
Baixei pra minha máquina e analisei pelo strings e identifiquei que o "date" está rodando sem especificar o caminho, podemos ganhar vantagem disso criando um script "date" malicioso e alterando o PATH para chamar ele e assim ganhar uma shell
![[Pasted image 20240224060003.png]]

exportando o diretório TMP e o diretório atual.
![[Pasted image 20240224060132.png]]
Arquivo date malicioso criado e enviado para o diretorio TMP com permissão de execução
![[Pasted image 20240224060318.png]]
Executado o programa e ganhando a shell do hatter
![[Pasted image 20240224060406.png]]

Encontrado um arquivo de senha dentro do diretório do usuário hatter. Após alguns testes validei que é a senha do próprio usuário.
![[Pasted image 20240224060451.png]]
```
WhyIsARavenLikeAWritingDesk?
```
Com isso foi possível logar no ssh com o usuário e senha do hatter